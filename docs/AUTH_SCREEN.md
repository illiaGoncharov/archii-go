# Экран авторизации ArchiGo

## Философия дизайна: Структурная эстетика

Экран авторизации следует принципам "Структурной эстетики" — минималистичного дизайна, вдохновленного архитектурными чертежами и современными B2B-интерфейсами (Linear, Figma, GitHub).

### Ключевые принципы:
- **Много воздуха** — щедрые отступы, минимум элементов
- **Тонкие линии** — border 1px, без теней
- **Строгая геометрия** — border-radius максимум 6px
- **Чистый фон** — #F6F8FA (светлый камень)
- **Один акцент** — только кнопка "Войти" синего цвета

### Отличия от типичных мобильных приложений:
❌ Градиенты, тени, скругления >8px  
❌ Иконки в полях ввода  
❌ Яркие цвета и иллюстрации  
❌ Социальные кнопки (Google, Apple)  

✅ Простой текстовый логотип  
✅ Поля с тонкой рамкой  
✅ Переключатель режима через подчеркивание  
✅ Ghost button для второстепенных действий  

## Структура файлов

### Созданные файлы

**app/auth.tsx** — Основной экран авторизации
- Два режима: вход и регистрация
- Переключатель: текст с underline (не табы)
- Форма: максимальная ширина 320px, по центру
- Поля: белый фон, тонкая граница 1px
- Кнопки: высота 44px, border-radius 6px

### Обновленные файлы

**services/auth.ts**
- Добавлен `signInAnonymously()` для анонимного входа

**app/_layout.tsx**
- Добавлен экран `auth` в Stack навигацию

**app/index.tsx**
- Проверка авторизации при запуске
- Перенаправление на `/auth` или `/(tabs)`

## Цветовая палитра

```
Фон:         #F6F8FA  (светло-серый, как бумага)
Поля:        #FFFFFF  (белый)
Border:      #D0D7DE  (тонкая линия)
Акцент:      #0969DA  (кнопка "Войти")
Текст:       #24292F  (основной)
             #57606A  (вторичный)
             #8C959F  (placeholder)
Ошибка:      #CF222E  (красный)
```

## Типографика

```
Заголовок:   32px, weight 600, letter-spacing -0.5
Подзаголовок: 14px, weight 400
Поля:        14px, weight 400, line-height 20
Кнопки:      14px, weight 500
Ошибки:      12px, weight 400
```

## Layout

```
┌─────────────────────────────┐
│                             │
│         ArchiGo             │  ← 80px сверху
│   Собирай архитектуру...    │
│                             │  ← 64px отступ
│     Вход · Регистрация      │  ← текст с underline
│                             │  ← 32px отступ
│  ┌───────────────────────┐  │
│  │ Email                 │  │  ← max-width 320px
│  └───────────────────────┘  │  ← 12px между полями
│  ┌───────────────────────┐  │
│  │ Пароль                │  │
│  └───────────────────────┘  │
│                             │
│         Забыл пароль        │  ← 12px, справа
│                             │
│  ┌───────────────────────┐  │
│  │       Войти           │  │  ← 44px высота
│  └───────────────────────┘  │
│  ┌───────────────────────┐  │
│  │   Войти анонимно      │  │  ← ghost button
│  └───────────────────────┘  │
│                             │
└─────────────────────────────┘
```

## Функциональность

### Режим "Вход"
- Поля: Email, Пароль
- Кнопки: "Войти" (синяя), "Войти анонимно" (ghost)
- Ссылка: "Забыл пароль" (справа, мелкий текст)

### Режим "Регистрация"
- Поля: Имя, Email, Пароль, Подтверждение пароля
- Кнопки: "Зарегистрироваться", "Войти анонимно"

### Переключение режимов
Простой текст с разделителем:
```
Вход · Регистрация
^^^^   
(подчеркивание у активного режима)
```

## Валидация

**Email**
- Проверка формата (regex)
- Ошибка: "Введите email" или "Неверный формат email"

**Пароль**
- Минимум 6 символов
- Ошибка: "Введите пароль" или "Минимум 6 символов"

**Подтверждение пароля** (только регистрация)
- Совпадение с основным паролем
- Ошибка: "Подтвердите пароль" или "Пароли не совпадают"

**Имя** (только регистрация)
- Обязательное поле
- Ошибка: "Введите имя"

Ошибки отображаются под полями, красным цветом (#CF222E), 12px.

## Обработка ошибок Firebase

Локализованные сообщения:
```
auth/user-not-found         → "Пользователь не найден"
auth/wrong-password         → "Неверный пароль"
auth/email-already-in-use   → "Email уже используется"
auth/weak-password          → "Пароль слишком простой"
auth/invalid-email          → "Неверный формат email"
auth/too-many-requests      → "Слишком много попыток. Попробуйте позже"
auth/network-request-failed → "Ошибка сети. Проверьте подключение"
Прочие                      → "Произошла ошибка. Попробуйте позже"
```

## Состояния

**Загрузка**
- ActivityIndicator внутри кнопки (белый цвет)
- Opacity 0.5 для обеих кнопок
- Отключены все инпуты и кнопки

**Ошибка валидации**
- Красная граница у поля (#CF222E)
- Текст ошибки под полем
- Ошибка исчезает при вводе

**Ошибка Firebase**
- Alert с заголовком и сообщением
- Локализованный текст

## Навигация

**После успешной авторизации:**
1. Обновляется `userStore.setUser(user)`
2. Переход: `router.replace('/(tabs)')`

**При запуске приложения (app/index.tsx):**
- Проверка: `getCurrentUser()` или `userStore.user`
- Если авторизован → `/(tabs)`
- Если нет → `/auth`

## Технические детали

### TypeScript
- Strict mode включен
- Типизация: `FirebaseError` для ошибок
- Типы режимов: `type AuthMode = 'signin' | 'signup'`

### State Management
- Локальное состояние (useState) для формы
- Zustand store (`userStore`) для глобального состояния пользователя

### Firebase Integration
- Firebase Auth (email/password + anonymous)
- Firestore для профилей (только для обычной регистрации)
- Анонимный вход создает временного пользователя без записи в Firestore

### Адаптивность
- SafeAreaView для безопасных областей
- KeyboardAvoidingView для iOS
- ScrollView для маленьких экранов
- Форма max-width 320px, центрирована

## Код стилей (ключевые значения)

```typescript
// Отступы
marginTop: 80         // Заголовок от верха
marginBottom: 64      // Заголовок от формы
marginBottom: 32      // Переключатель от полей
marginBottom: 12      // Между полями
marginTop: 16         // Перед основной кнопкой
marginTop: 12         // Перед ghost кнопкой

// Размеры
maxWidth: 320         // Форма
height: 44            // Кнопки
paddingVertical: 14   // Поля ввода
paddingHorizontal: 14 // Поля ввода

// Границы
borderWidth: 1        // Везде
borderRadius: 6       // Поля, кнопки

// Цвета (hardcoded для точности)
backgroundColor: '#F6F8FA'  // Фон экрана
backgroundColor: '#FFFFFF'  // Поля ввода
borderColor: '#D0D7DE'      // Границы
backgroundColor: '#0969DA'  // Основная кнопка
color: '#24292F'            // Основной текст
color: '#57606A'            // Вторичный текст
placeholderTextColor: '#8C959F'  // Placeholder
borderColor: '#CF222E'      // Ошибка
```

## Референсы дизайна

Экран вдохновлен:
- **Linear** — минимализм, тонкие линии, много воздуха
- **GitHub** — цветовая палитра, типографика
- **Figma** — простота, отсутствие лишнего
- **Arc Browser** — чистота, элегантность

## Возможные улучшения

1. **Восстановление пароля**
   - Реализация `sendPasswordResetEmail`
   - Модальное окно или отдельный экран

2. **OAuth провайдеры**
   - Google, Apple Sign-In
   - Стиль: минималистичные кнопки с логотипами

3. **Показ/скрытие пароля**
   - Иконка глаза справа в поле (но не обязательно)

4. **Email verification**
   - Автоматическая проверка при регистрации

5. **Биометрия**
   - Face ID / Touch ID для повторного входа

6. **Анимации**
   - Плавные переходы между режимами
   - Но очень тонкие, почти незаметные
