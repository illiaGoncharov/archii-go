# Cursor Rules для Archi-Go

## Язык общения
- Всегда отвечай и пиши код на русском языке
- Комментарии в коде на русском (где нужны пояснения)
- Документация на русском

## Git Commits
- Используй Conventional Commits: https://www.conventionalcommits.org/
- Формат: `<type>(<scope>): <description>`
- Types:
  - `feat`: новая функциональность
  - `fix`: исправление бага
  - `docs`: изменения в документации
  - `style`: форматирование, отступы (не влияет на код)
  - `refactor`: рефакторинг без изменения функциональности
  - `perf`: улучшение производительности
  - `test`: добавление тестов
  - `chore`: обновление зависимостей, конфигов

Примеры:
```
feat(camera): добавить превью перед отправкой фото
fix(map): исправить отображение POI на карте
docs: обновить инструкцию по настройке Firebase
refactor(stores): вынести логику загрузки в отдельную функцию
```

## Стиль кода

### TypeScript
- Всегда используй строгую типизацию
- Избегай `any`, используй `unknown` при необходимости
- Предпочитай `interface` над `type` для объектов
- Используй `enum` для константных значений с несколькими вариантами

### React Native / Expo
- Используй функциональные компоненты с хуками
- Используй `StyleSheet.create()` для стилей
- Группируй стили логически (layout, colors, typography)
- Избегай инлайн стилей (кроме динамических)

### Именование
- Компоненты: `PascalCase` (ElementCard, POIMarker)
- Функции/переменные: `camelCase` (getUserData, isLoading)
- Константы: `UPPER_SNAKE_CASE` (MAX_POINTS, API_URL)
- Файлы компонентов: `PascalCase.tsx`
- Файлы сервисов/утилит: `camelCase.ts`

### Структура файлов
- Imports группируются:
  1. React / React Native
  2. Сторонние библиотеки
  3. Локальные компоненты
  4. Типы
  5. Утилиты
  6. Стили

Пример:
```typescript
import { useState, useEffect } from 'react';
import { View, Text, StyleSheet } from 'react-native';
import { Ionicons } from '@expo/vector-icons';

import ElementCard from '../components/ElementCard';
import { Element } from '../types/element';
import { calculateRarity } from '../utils/rarity';
```

### Комментарии
- Пиши комментарии для сложной логики
- Используй JSDoc для публичных функций
- Избегай очевидных комментариев

Пример:
```typescript
// ❌ Плохо
const x = 10; // Задаём x равным 10

// ✅ Хорошо
// Максимальное количество элементов на одной странице для оптимизации производительности
const MAX_ITEMS_PER_PAGE = 10;

/**
 * Вычисляет редкость элемента на основе количества находок
 * @param totalFound - Общее количество находок всеми пользователями
 * @returns Уровень редкости элемента
 */
function calculateRarity(totalFound: number): Rarity {
  // ...
}
```

## Zustand Stores
- Один store = одна область ответственности
- Используй `create` с типизацией
- Действия (actions) в том же store
- Не храни производные данные (computed values)

## Firebase
- Всегда оборачивай вызовы в try/catch
- Показывай понятные ошибки пользователю
- Логируй ошибки для отладки

## Производительность
- Используй `useMemo` для тяжёлых вычислений
- Используй `useCallback` для функций в зависимостях
- FlatList для длинных списков (не ScrollView)
- Оптимизируй изображения (resize, compress)

## Доступность (a11y)
- Добавляй `accessibilityLabel` для интерактивных элементов
- Используй семантические компоненты (TouchableOpacity для кнопок)
- Проверяй контрастность текста

## Безопасность
- Никогда не коммить Firebase keys в публичный репозиторий
- Используй .env для секретов (в production)
- Валидируй данные на клиенте и сервере

## Тестирование
- Тестируй критичные функции (утилиты, расчёты)
- Проверяй на реальном устройстве (не только симулятор)
- Тестируй разные разрешения экранов

## UI/UX
- Следуй дизайн-гайду (docs/DESIGN_GUIDE.md)
- Используй константы цветов из дизайн-системы
- Обеспечь feedback на действия пользователя (loading, success, error)
- Анимации должны быть быстрыми (200-300ms)

## Code Review принципы
- DRY (Don't Repeat Yourself)
- KISS (Keep It Simple, Stupid)
- YAGNI (You Aren't Gonna Need It)
- Single Responsibility Principle

## Обработка ошибок
- Показывай пользователю понятные сообщения
- Логируй детали ошибки для разработчика
- Предлагай способ решения проблемы

Пример:
```typescript
try {
  await uploadPhoto(uri);
} catch (error) {
  console.error('Ошибка загрузки фото:', error);
  Alert.alert(
    'Не удалось загрузить фото',
    'Проверьте интернет-соединение и попробуйте снова'
  );
}
```

## Best Practices
- Не используй магические числа (выноси в константы)
- Предпочитай async/await над .then()
- Используй optional chaining (?.) и nullish coalescing (??)
- Деструктуризация для чистоты кода

## Документация
- Обновляй README при изменении функциональности
- Документируй API функции
- Пиши понятные commit messages

